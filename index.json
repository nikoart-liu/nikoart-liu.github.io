[{"content":"一、环境准备及 Hugo 安装 安装 Homebrew 如果你还没有安装 Homebrew，请先打开终端执行以下命令来安装这个 macOS 上最常用的包管理器：\n/bin/bash -c \u0026#34;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\u0026#34; 使用 Homebrew 安装 Hugo Homebrew 安装包的方式非常简洁，一条命令即可完成：\nbrew install hugo 安装完成后，验证 Hugo 是否正确安装：\nhugo version 如果终端显示类似 hugo v0.155.0+extended+withdeploy darwin/arm64 BuildDate=2026-01-28T16:28:23Z VendorInfo=Homebrew 的版本信息，说明安装成功。\n二、创建 Hugo 站点 初始化站点 使用 Hugo 命令创建一个全新的网站基础结构：\nhugo new site my-blog --format=yaml cd my-blog git init 执行完成后，Hugo 会创建一个名为 my-blog 的目录。进入这个目录查看自动生成的文件结构：\nmy-blog/ ├── archetypes/ │ └── default.md ├── content/ ├── layouts/ ├── static/ ├── themes/ └── hugo.yaml 这个结构的设计非常清晰：\narchetypes 用于定义文章模板 content 存放你的文章内容 layouts 控制页面布局 static 存放静态资源如图片 themes 用于放置主题 hugo.yaml 站点配置文件 启动 Hugo 的开发服务器以查看站点：\nhugo server 配置站点信息 打开 hugo.yaml，进行基本的站点配置：\nbaseURL: \u0026#39;https://nikoart-liu.github.io/\u0026#39; title: \u0026#39;my blog\u0026#39; theme: \u0026#39;PaperMod\u0026#39; languageCode: \u0026#39;zh-CN\u0026#39; params: author: \u0026#39;author\u0026#39; description: \u0026#39;\u0026#39; defaultTheme: \u0026#39;auto\u0026#39; ShowReadingTime: true ShowPostNavLinks: true ShowBreadCrumbs: true ShowWordCount: true ShowReadingProgress: true ShowScrollToTop: true homeInfoParams: Title: \u0026#39;Hello\u0026#39; Content: \u0026#39;\u0026#39; socialIcons: - name: \u0026#39;github\u0026#39; url: \u0026#39;https://github.com/nikoart-liu\u0026#39; fuseOpts: isCaseSensitive: false shouldSort: true location: 0 distance: 1000 threshold: 0.4 minMatchCharLength: 0 keys: [\u0026#34;title\u0026#34;, \u0026#34;permalink\u0026#34;, \u0026#34;summary\u0026#34;, \u0026#34;content\u0026#34;] menu: main: - identifier: \u0026#39;archives\u0026#39; name: \u0026#39;归档\u0026#39; url: \u0026#39;/archives/\u0026#39; weight: 5 - name: \u0026#34;分类\u0026#34; url: \u0026#34;/categories/\u0026#34; weight: 10 - identifier: \u0026#39;tags\u0026#39; name: \u0026#39;标签\u0026#39; url: \u0026#39;/tags/\u0026#39; weight: 15 - identifier: \u0026#34;search\u0026#34; name: \u0026#34;搜索\u0026#34; url: \u0026#34;/search/\u0026#34; weight: 20 outputs: home: [\u0026#34;HTML\u0026#34;, \u0026#34;RSS\u0026#34;, \u0026#34;JSON\u0026#34;] 安装主题 上面的配置使用了 PaperMod 主题，可以使用 git submodule 的方式来安装：\ngit submodule add --depth=1 https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod git submodule update --init --recursive # needed when you reclone your repo (submodules may not get cloned automatically) 更新，在你的站点目录下运行：\ngit submodule update --remote --merge 在站点配置文件中添加主题：\ntheme: [\u0026#34;PaperMod\u0026#34;] 添加搜索页：将以下内容添加到站点配置中，\noutputs: home: [\u0026#34;HTML\u0026#34;, \u0026#34;RSS\u0026#34;, \u0026#34;JSON\u0026#34;] 在 content 目录中创建一个带有 search.md 的页面，包含以下内容：\n--- title: \u0026#34;Search\u0026#34; # in any language you want layout: \u0026#34;search\u0026#34; # necessary for search # url: \u0026#34;/archive\u0026#34; # description: \u0026#34;Description for Search\u0026#34; summary: \u0026#34;search\u0026#34; placeholder: \u0026#34;placeholder text in search input box\u0026#34; --- 更多安装说明可参考：\nurl: https://github.com/adityatelange/hugo-PaperMod/wiki/Installation title: \u0026#34;Installation\u0026#34; description: \u0026#34;A fast, clean, responsive Hugo theme. Contribute to adityatelange/hugo-PaperMod development by creating an account on GitHub.\u0026#34; host: github.com favicon: https://github.githubassets.com/favicons/favicon.svg image: https://opengraph.githubassets.com/caec80fe0b5c3a27a9aaaa5fe2f852377e5baa7d7a3c8b9efe052cd129aafd74/adityatelange/hugo-PaperMod 更多主题：\nurl: https://themes.gohugo.io/ title: \u0026#34;Hugo Themes\u0026#34; description: \u0026#34;The world’s fastest framework for building websites\u0026#34; host: themes.gohugo.io favicon: https://themes.gohugo.io/favicon-32x32.png image: https://themes.gohugo.io/opengraph/gohugoio-card-base-1_hu_9c01cb56a2662d2e.png 三、发布到 Github Pages 在 github 上创建两个仓库：\n源码仓库，用来对站点配置版本管理 page 仓库，管理 public 目录下的静态资源（仓库名必须是 \u0026lt;username\u0026gt;.github.io,并且是公开仓库） 配置 Action 首先，需要申请一个 PAT（Personal access token），可以在 profile-\u0026gt;settings-\u0026gt;Developer settings-\u0026gt;Personal access tokens-\u0026gt;Token(classic) 创建，创建完成后复制，在源码仓库的 Settings-\u0026gt;Secrets and variables-\u0026gt;Actions-\u0026gt;Repository secrets ，点击 New repository secret，保存token，Name 必须是 PAGES_REPO_TOKEN，与 workflow 中的配置一致。\n在源码仓库中，选择 Actions，点击 New workflow 创建一个新的工作流，对应 .github/workflows/hugo.yml，填入一下内容：\nname: Deploy Hugo site to Pages Repo on: push: branches: [\u0026#34;master\u0026#34;] workflow_dispatch: permissions: contents: read concurrency: group: \u0026#34;pages\u0026#34; cancel-in-progress: false defaults: run: shell: bash jobs: build-and-deploy: runs-on: ubuntu-latest env: HUGO_VERSION: 0.155.0 steps: # 先 checkout，再安装依赖（顺序重要） - name: Checkout uses: actions/checkout@v4 with: submodules: recursive fetch-depth: 0 token: ${{ secrets.GITHUB_TOKEN }} # 确保能拉取私有 submodule - name: Install Hugo CLI run: | wget -O ${{ runner.temp }}/hugo.deb https://github.com/gohugoio/hugo/releases/download/v${HUGO_VERSION}/hugo_extended_${HUGO_VERSION}_linux-amd64.deb \\ \u0026amp;\u0026amp; sudo dpkg -i ${{ runner.temp }}/hugo.deb hugo version - name: Install Dart Sass run: sudo snap install dart-sass - name: Update theme submodule run: | git submodule update --remote --merge || echo \u0026#34;Using existing submodule commit\u0026#34; git submodule status - name: Install Node.js dependencies run: \u0026#34;[[ -f package-lock.json || -f npm-shrinkwrap.json ]] \u0026amp;\u0026amp; npm ci || true\u0026#34; - name: Build with Hugo env: HUGO_CACHEDIR: ${{ runner.temp }}/hugo_cache HUGO_ENVIRONMENT: production HUGO_ENV: production run: | rm -rf public hugo \\ --gc \\ --cleanDestinationDir \\ --minify \\ --baseURL \u0026#34;https://nikoart-liu.github.io/\u0026#34; # 验证构建输出 ls -la public/ - name: Deploy to Pages Repository uses: peaceiris/actions-gh-pages@v4 with: personal_token: ${{ secrets.PAGES_REPO_TOKEN }} external_repository: nikoart-liu/nikoart-liu.github.io publish_branch: master publish_dir: ./public commit_message: \u0026#39;Auto deploy from source repo: ${{ github.event.head_commit.message }}\u0026#39; user_name: \u0026#39;github-actions[bot]\u0026#39; user_email: \u0026#39;github-actions[bot]@users.noreply.github.com\u0026#39; # 可选：强制推送（如果历史混乱） # force_orphan: true 当源码仓库推送变更后，会触发 Actions 执行操作。\n源码仓库添加一个 .gitignore，避免将本地的public 目录提交到仓库。\npublic/ 配置 Pages 在 page 仓库的 Settings 中，点击左侧 Pages 菜单，在 Build and deployment 一栏中，将 Source 修改成 Deploy from a branch，Branch 选择正确的分支。\n当源码仓库触发 Actions 之后，可以在此页面看见上次部署的时间。\n","permalink":"https://nikoart-liu.github.io/posts/hugo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E5%B9%B6%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2/","summary":"\u003ch1 id=\"一环境准备及-hugo-安装\"\u003e一、环境准备及 Hugo 安装\u003c/h1\u003e\n\u003ch2 id=\"安装-homebrew\"\u003e安装 Homebrew\u003c/h2\u003e\n\u003cp\u003e如果你还没有安装 Homebrew，请先打开终端执行以下命令来安装这个 macOS 上最常用的包管理器：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/bin/bash -c \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003e$(\u003c/span\u003ecurl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh\u003cspan style=\"color:#66d9ef\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"使用-homebrew-安装-hugo\"\u003e使用 Homebrew 安装 Hugo\u003c/h2\u003e\n\u003cp\u003eHomebrew 安装包的方式非常简洁，一条命令即可完成：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebrew install hugo\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e安装完成后，验证 Hugo 是否正确安装：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehugo version\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e如果终端显示类似 \u003ccode\u003ehugo v0.155.0+extended+withdeploy darwin/arm64 BuildDate=2026-01-28T16:28:23Z VendorInfo=Homebrew\u003c/code\u003e 的版本信息，说明安装成功。\u003c/p\u003e\n\u003ch1 id=\"二创建-hugo-站点\"\u003e二、创建 Hugo 站点\u003c/h1\u003e\n\u003ch2 id=\"初始化站点\"\u003e初始化站点\u003c/h2\u003e\n\u003cp\u003e使用 Hugo 命令创建一个全新的网站基础结构：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehugo new site my-blog --format\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eyaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd my-blog\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit init\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e执行完成后，Hugo 会创建一个名为 my-blog 的目录。进入这个目录查看自动生成的文件结构：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emy-blog/\n├── archetypes/\n│   └── default.md\n├── content/\n├── layouts/\n├── static/\n├── themes/\n└── hugo.yaml\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e这个结构的设计非常清晰：\u003c/p\u003e","title":"Hugo 搭建博客并部署到 Github Pages 指南"},{"content":"Rust - 迭代器与闭包 知识概览 核心主题：Iterator trait、惰性求值、常用适配器 (map, filter, collect)、闭包捕获与 Fn/FnMut/FnOnce。 重要性：⭐⭐⭐⭐⭐ 在数据处理、流式计算、函数式编程中必备。 前置知识：所有权、借用、match、Result（错误处理）。 核心概念 1. Iterator trait \u0026amp; 惰性求值 trait Iterator { type Item; fn next(\u0026amp;mut self) -\u0026gt; Option\u0026lt;Self::Item\u0026gt;; } 惰性：仅在调用 next()（或消费方法如 collect, fold）时产生元素。 优势：省内存、可提前终止（如 find、any），提升性能。 2. 迭代器常用方法 方法 说明 示例 into_iter() 消费所有权，返回 T vec.into_iter() iter() 只读引用 \u0026amp;T vec.iter() filter 过滤满足条件的元素 .filter(|x| x% 2 == 0) map 转换元素 .map(|x| x * x) collect 收集到容器 .collect::\u0026lt;Vec\u0026lt;_\u0026gt;\u0026gt;() fold 累积状态 .fold(0,|acc, x| acc + x) 检查点答案 iter() 返回 \u0026amp;T 迭代器，into_iter() 返回拥有所有权的 T。 collect() 在 filter+map 链中只会在最终调用时遍历一次。 3. 闭包捕获方式 捕获方式 关键字 适用场景 按引用 无 filter(|x| x.starts_with(prefix))（prefix 为 \u0026amp;str） 按可变引用 \u0026amp;mut for_each(|x| cnt += 1) 按值 (move) move 需要所有权，如 let s = String::from(\u0026quot;hi\u0026quot;); let c = move |x| x; Fn：只读捕获（filter, map） FnMut：可变捕获（for_each 改变外部变量） FnOnce：移动捕获（一次性消费） 4. 链式适配器与实际案例 词频统计（示例） use std::collections::HashMap; use std::fs; fn main() { let text = fs::read_to_string(\u0026#34;poem.txt\u0026#34;).expect(\u0026#34;read failed\u0026#34;); // 统计所有单词频率 let freq: HashMap\u0026lt;String, usize\u0026gt; = text .split_whitespace() .fold(HashMap::new(), |mut map, word| { *map.entry(word.to_string()).or_insert(0) += 1; map }) // 过滤出现次数 \u0026gt;= 2 的词 .into_iter() .filter(|(_, count)| *count \u0026gt;= 2) .collect(); println!(\u0026#34;{:?}\u0026#34;, freq); } 关键在 into_iter() 后再 filter，避免引用与所有权冲突。 常见陷阱 问题 原因 解决方案 collect() 后的 HashMap 再 iter() 导致引用错误 需要拥有所有权进行过滤 使用 into_iter() 或克隆键值 在 filter 中捕获 String 而不 move 默认按引用捕获导致借用冲突 加 move 或使用 \u0026amp;str 预先借用 误把 iter() 当作消费所有权 iter() 只借用，后续使用会报错 根据需求选择 into_iter() 或 iter() 关键要点 惰性：只有在消费时才遍历。 所有权 vs 引用：into_iter() 消费，iter() 借用。 闭包捕获：move 取得所有权，Fn/FnMut/FnOnce 对应捕获方式。 链式：filter -\u0026gt; map -\u0026gt; collect 形成数据管道，保持简洁。 错误处理：Result 与 expect 用于文件读取等 IO 操作。 ","permalink":"https://nikoart-liu.github.io/posts/rust%E8%BF%AD%E4%BB%A3%E5%99%A8%E4%B8%8E%E9%97%AD%E5%8C%85/","summary":"\u003ch1 id=\"rust---迭代器与闭包\"\u003eRust - 迭代器与闭包\u003c/h1\u003e\n\u003ch2 id=\"知识概览\"\u003e知识概览\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e核心主题\u003c/strong\u003e：Iterator trait、惰性求值、常用适配器 (\u003ccode\u003emap\u003c/code\u003e, \u003ccode\u003efilter\u003c/code\u003e, \u003ccode\u003ecollect\u003c/code\u003e)、闭包捕获与 \u003ccode\u003eFn\u003c/code\u003e/\u003ccode\u003eFnMut\u003c/code\u003e/\u003ccode\u003eFnOnce\u003c/code\u003e。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e重要性\u003c/strong\u003e：⭐⭐⭐⭐⭐ 在数据处理、流式计算、函数式编程中必备。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e前置知识\u003c/strong\u003e：所有权、借用、\u003ccode\u003ematch\u003c/code\u003e、\u003ccode\u003eResult\u003c/code\u003e（错误处理）。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"核心概念\"\u003e核心概念\u003c/h2\u003e\n\u003ch3 id=\"1-iterator-trait--惰性求值\"\u003e1. Iterator trait \u0026amp; 惰性求值\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-rust\" data-lang=\"rust\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003etrait\u003c/span\u003e Iterator {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003etype\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eItem\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003enext\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003emut\u003c/span\u003e self) -\u0026gt; Option\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eSelf::Item\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e惰性\u003c/strong\u003e：仅在调用 \u003ccode\u003enext()\u003c/code\u003e（或消费方法如 \u003ccode\u003ecollect\u003c/code\u003e, \u003ccode\u003efold\u003c/code\u003e）时产生元素。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e优势\u003c/strong\u003e：省内存、可提前终止（如 \u003ccode\u003efind\u003c/code\u003e、\u003ccode\u003eany\u003c/code\u003e），提升性能。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"2-迭代器常用方法\"\u003e2. 迭代器常用方法\u003c/h3\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e方法\u003c/th\u003e\n          \u003cth\u003e说明\u003c/th\u003e\n          \u003cth\u003e示例\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003einto_iter()\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e消费所有权，返回 \u003ccode\u003eT\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003evec.into_iter()\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eiter()\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e只读引用 \u003ccode\u003e\u0026amp;T\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003evec.iter()\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003efilter\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e过滤满足条件的元素\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003e.filter(|x| x% 2 == 0)\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003emap\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e转换元素\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003e.map(|x| x * x)\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003ecollect\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e收集到容器\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003e.collect::\u0026lt;Vec\u0026lt;_\u0026gt;\u0026gt;()\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003efold\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e累积状态\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003e.fold(0,|acc, x| acc + x)\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch4 id=\"检查点答案\"\u003e检查点答案\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eiter()\u003c/code\u003e 返回 \u003ccode\u003e\u0026amp;T\u003c/code\u003e 迭代器，\u003ccode\u003einto_iter()\u003c/code\u003e 返回拥有所有权的 \u003ccode\u003eT\u003c/code\u003e。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ecollect()\u003c/code\u003e 在 \u003ccode\u003efilter\u003c/code\u003e+\u003ccode\u003emap\u003c/code\u003e 链中只会在最终调用时遍历一次。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"3-闭包捕获方式\"\u003e3. 闭包捕获方式\u003c/h3\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e捕获方式\u003c/th\u003e\n          \u003cth\u003e关键字\u003c/th\u003e\n          \u003cth\u003e适用场景\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e按引用\u003c/td\u003e\n          \u003ctd\u003e无\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003efilter(|x| x.starts_with(prefix))\u003c/code\u003e\u003c!-- raw HTML omitted --\u003e（\u003ccode\u003eprefix\u003c/code\u003e 为 \u003ccode\u003e\u0026amp;str\u003c/code\u003e）\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e按可变引用\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003e\u0026amp;mut\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003efor_each(|x| cnt += 1)\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e按值 (move)\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003emove\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e需要所有权，如 \u003ccode\u003elet s = String::from(\u0026quot;hi\u0026quot;); let c = move |x| x;\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eFn\u003c/code\u003e\u003c/strong\u003e：只读捕获（\u003ccode\u003efilter\u003c/code\u003e, \u003ccode\u003emap\u003c/code\u003e）\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eFnMut\u003c/code\u003e\u003c/strong\u003e：可变捕获（\u003ccode\u003efor_each\u003c/code\u003e 改变外部变量）\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eFnOnce\u003c/code\u003e\u003c/strong\u003e：移动捕获（一次性消费）\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"4-链式适配器与实际案例\"\u003e4. 链式适配器与实际案例\u003c/h3\u003e\n\u003ch4 id=\"词频统计示例\"\u003e词频统计（示例）\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-rust\" data-lang=\"rust\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003euse\u003c/span\u003e std::collections::HashMap;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003euse\u003c/span\u003e std::fs;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e text \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e fs::read_to_string(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;poem.txt\u0026#34;\u003c/span\u003e).expect(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;read failed\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// 统计所有单词频率\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e freq: \u003cspan style=\"color:#a6e22e\"\u003eHashMap\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eString, \u003cspan style=\"color:#66d9ef\"\u003eusize\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e text\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        .split_whitespace()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        .fold(HashMap::new(), \u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003emut\u003c/span\u003e map, word\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003emap.entry(word.to_string()).or_insert(\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            map\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        })\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e// 过滤出现次数 \u0026gt;= 2 的词\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        .into_iter()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        .filter(\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e(_, count)\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003ecount \u003cspan style=\"color:#f92672\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        .collect();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eprintln!\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e{:?}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e, freq);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e关键在 \u003cstrong\u003e\u003ccode\u003einto_iter()\u003c/code\u003e\u003c/strong\u003e 后再 \u003ccode\u003efilter\u003c/code\u003e，避免引用与所有权冲突。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"常见陷阱\"\u003e常见陷阱\u003c/h2\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e问题\u003c/th\u003e\n          \u003cth\u003e原因\u003c/th\u003e\n          \u003cth\u003e解决方案\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003ecollect()\u003c/code\u003e 后的 \u003ccode\u003eHashMap\u003c/code\u003e 再 \u003ccode\u003eiter()\u003c/code\u003e 导致引用错误\u003c/td\u003e\n          \u003ctd\u003e需要拥有所有权进行过滤\u003c/td\u003e\n          \u003ctd\u003e使用 \u003ccode\u003einto_iter()\u003c/code\u003e 或克隆键值\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e在 \u003ccode\u003efilter\u003c/code\u003e 中捕获 \u003ccode\u003eString\u003c/code\u003e 而不 \u003ccode\u003emove\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e默认按引用捕获导致借用冲突\u003c/td\u003e\n          \u003ctd\u003e加 \u003ccode\u003emove\u003c/code\u003e 或使用 \u003ccode\u003e\u0026amp;str\u003c/code\u003e 预先借用\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e误把 \u003ccode\u003eiter()\u003c/code\u003e 当作消费所有权\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eiter()\u003c/code\u003e 只借用，后续使用会报错\u003c/td\u003e\n          \u003ctd\u003e根据需求选择 \u003ccode\u003einto_iter()\u003c/code\u003e 或 \u003ccode\u003eiter()\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"关键要点\"\u003e关键要点\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003e惰性\u003c/strong\u003e：只有在消费时才遍历。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e所有权 vs 引用\u003c/strong\u003e：\u003ccode\u003einto_iter()\u003c/code\u003e 消费，\u003ccode\u003eiter()\u003c/code\u003e 借用。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e闭包捕获\u003c/strong\u003e：\u003ccode\u003emove\u003c/code\u003e 取得所有权，\u003ccode\u003eFn\u003c/code\u003e/\u003ccode\u003eFnMut\u003c/code\u003e/\u003ccode\u003eFnOnce\u003c/code\u003e 对应捕获方式。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e链式\u003c/strong\u003e：\u003ccode\u003efilter -\u0026gt; map -\u0026gt; collect\u003c/code\u003e 形成数据管道，保持简洁。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e错误处理\u003c/strong\u003e：\u003ccode\u003eResult\u003c/code\u003e 与 \u003ccode\u003eexpect\u003c/code\u003e 用于文件读取等 IO 操作。\u003c/li\u003e\n\u003c/ol\u003e","title":"Rust - 迭代器与闭包"},{"content":"Rust - I/O 知识概览 核心主题：构建命令行搜索工具（minigrep） 重要性：⭐⭐⭐⭐⭐ 综合应用前几章知识 前置知识：环境安装、所有权、Trait、错误处理 核心概念 命令行参数解析 use std::env; fn main() { let args: Vec\u0026lt;String\u0026gt; = env::args().collect(); // args[0] = 程序名 // args[1] = 第一个参数 // args[2] = 第二个参数 println!(\u0026#34;搜索词: {}\u0026#34;, args[1]); println!(\u0026#34;文件: {}\u0026#34;, args[2]); } 文件读取 use std::fs; let contents = fs::read_to_string(filename) .expect(\u0026#34;无法读取文件\u0026#34;); // contents 是 String，包含整个文件内容 配置模式（Config Pattern） struct Config { query: String, filename: String, case_sensitive: bool, } impl Config { fn new(args: \u0026amp;[String]) -\u0026gt; Result\u0026lt;Config, \u0026amp;\u0026#39;static str\u0026gt; { if args.len() \u0026lt; 3 { return Err(\u0026#34;参数不足\u0026#34;); } let query = args[1].clone(); let filename = args[2].clone(); let case_sensitive = !args.iter().any(|arg| arg == \u0026#34;-i\u0026#34;); Ok(Config { query, filename, case_sensitive }) } } 错误处理 场景 方式 示例 致命错误 expect fs::read_to_string(...).expect(...) 可恢复错误 Result + match Config::new(...)? 用户提示 eprintln! eprintln!(\u0026quot;用法: ...\u0026quot;) 项目结构 minigrep/ ├── src/ │ └── main.rs # 主程序 ├── Cargo.toml └── poem.txt # 测试文件 完整代码 // src/main.rs use std::env; use std::fs; struct Config { query: String, filename: String, case_sensitive: bool, } impl Config { fn new(args: \u0026amp;[String]) -\u0026gt; Result\u0026lt;Config, \u0026amp;\u0026#39;static str\u0026gt; { if args.len() \u0026lt; 3 { return Err(\u0026#34;参数不足\u0026#34;); } let query = args[1].clone(); let filename = args[2].clone(); let case_sensitive = !args.iter().any(|arg| arg == \u0026#34;-i\u0026#34;); Ok(Config { query, filename, case_sensitive }) } } fn main() { let args: Vec\u0026lt;String\u0026gt; = env::args().collect(); let config = match Config::new(\u0026amp;args) { Ok(config) =\u0026gt; config, Err(e) =\u0026gt; panic!(\u0026#34;{e}\u0026#34;), }; let contents = fs::read_to_string(\u0026amp;config.filename) .expect(\u0026#34;无法读取文件\u0026#34;); let results = search(\u0026amp;config, \u0026amp;contents); for line in results { println!(\u0026#34;{line}\u0026#34;); } } fn search\u0026lt;\u0026#39;a\u0026gt;(config: \u0026amp;\u0026#39;a Config, contents: \u0026amp;\u0026#39;a str) -\u0026gt; Vec\u0026lt;\u0026amp;\u0026#39;a str\u0026gt; { let query = config.query.to_lowercase(); let mut results = Vec::new(); for line in contents.lines() { if config.case_sensitive { if line.contains(\u0026amp;config.query) { results.push(line); } } else { if line.to_lowercase().contains(\u0026amp;query) { results.push(line); } } } results } 运行命令 # 基本搜索 cargo run -- hello poem.txt # 大小写不敏感搜索 cargo run -- -i hello poem.txt 常见陷阱 问题 原因 解决方案 参数越界 忘记检查 args.len() 加长度检查 大小写搜索低效 query.to_lowercase() 重复计算 提取到循环外 所有权转移 String 传入函数 使用引用 \u0026amp;str 关键要点 env::args() 返回 Iterator fs::read_to_string() 读取整个文件 Config 模式解耦配置与业务逻辑 大小写不敏感：两边都转小写再比较 用 Result 处理用户输入错误更优雅 ","permalink":"https://nikoart-liu.github.io/posts/rustio/","summary":"\u003ch1 id=\"rust---io\"\u003eRust - I/O\u003c/h1\u003e\n\u003ch2 id=\"知识概览\"\u003e知识概览\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e核心主题\u003c/strong\u003e：构建命令行搜索工具（minigrep）\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e重要性\u003c/strong\u003e：⭐⭐⭐⭐⭐ 综合应用前几章知识\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e前置知识\u003c/strong\u003e：环境安装、所有权、Trait、错误处理\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"核心概念\"\u003e核心概念\u003c/h2\u003e\n\u003ch3 id=\"命令行参数解析\"\u003e命令行参数解析\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-rust\" data-lang=\"rust\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003euse\u003c/span\u003e std::env;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e args: Vec\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eString\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e env::args().collect();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// args[0] = 程序名\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// args[1] = 第一个参数\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// args[2] = 第二个参数\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eprintln!\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;搜索词: \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e{}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e, args[\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003eprintln!\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;文件: \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e{}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e, args[\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"文件读取\"\u003e文件读取\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-rust\" data-lang=\"rust\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003euse\u003c/span\u003e std::fs;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e contents \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e fs::read_to_string(filename)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    .expect(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;无法读取文件\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// contents 是 String，包含整个文件内容\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"配置模式config-pattern\"\u003e配置模式（Config Pattern）\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-rust\" data-lang=\"rust\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eConfig\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    query: String,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    filename: String,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    case_sensitive: \u003cspan style=\"color:#66d9ef\"\u003ebool\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eimpl\u003c/span\u003e Config {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003enew\u003c/span\u003e(args: \u003cspan style=\"color:#66d9ef\"\u003e\u0026amp;\u003c/span\u003e[String]) -\u0026gt; Result\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eConfig, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u0026#39;static \u003cspan style=\"color:#66d9ef\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e args.len() \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e Err(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;参数不足\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e query \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e args[\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e].clone();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e filename \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e args[\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e].clone();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e case_sensitive \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eargs.iter().any(\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003earg\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e arg \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-i\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Ok(Config { query, filename, case_sensitive })\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"错误处理\"\u003e错误处理\u003c/h3\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e场景\u003c/th\u003e\n          \u003cth\u003e方式\u003c/th\u003e\n          \u003cth\u003e示例\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e致命错误\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eexpect\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003efs::read_to_string(...).expect(...)\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e可恢复错误\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eResult\u003c/code\u003e + \u003ccode\u003ematch\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eConfig::new(...)?\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e用户提示\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eeprintln!\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eeprintln!(\u0026quot;用法: ...\u0026quot;)\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"项目结构\"\u003e项目结构\u003c/h2\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eminigrep/\n├── src/\n│   └── main.rs        # 主程序\n├── Cargo.toml\n└── poem.txt           # 测试文件\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"完整代码\"\u003e完整代码\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-rust\" data-lang=\"rust\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// src/main.rs\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003euse\u003c/span\u003e std::env;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003euse\u003c/span\u003e std::fs;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eConfig\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    query: String,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    filename: String,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    case_sensitive: \u003cspan style=\"color:#66d9ef\"\u003ebool\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eimpl\u003c/span\u003e Config {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003enew\u003c/span\u003e(args: \u003cspan style=\"color:#66d9ef\"\u003e\u0026amp;\u003c/span\u003e[String]) -\u0026gt; Result\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eConfig, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003e\u0026#39;static \u003cspan style=\"color:#66d9ef\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e args.len() \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e Err(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;参数不足\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e query \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e args[\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e].clone();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e filename \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e args[\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e].clone();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e case_sensitive \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003eargs.iter().any(\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003earg\u003cspan style=\"color:#f92672\"\u003e|\u003c/span\u003e arg \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-i\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Ok(Config { query, filename, case_sensitive })\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e args: Vec\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eString\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e env::args().collect();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e config \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003ematch\u003c/span\u003e Config::new(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eargs) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Ok(config) \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e config,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        Err(e) \u003cspan style=\"color:#f92672\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003epanic!\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e{e}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    };\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e contents \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e fs::read_to_string(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003econfig.filename)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        .expect(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;无法读取文件\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e results \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e search(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003econfig, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003econtents);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e line \u003cspan style=\"color:#66d9ef\"\u003ein\u003c/span\u003e results {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003eprintln!\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e{line}\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esearch\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003e\u0026#39;a\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e(config: \u003cspan style=\"color:#66d9ef\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003e\u0026#39;a\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eConfig\u003c/span\u003e, contents: \u003cspan style=\"color:#66d9ef\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003e\u0026#39;a\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estr\u003c/span\u003e) -\u0026gt; Vec\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003e\u0026#39;a\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e query \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e config.query.to_lowercase();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003emut\u003c/span\u003e results \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e Vec::new();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e line \u003cspan style=\"color:#66d9ef\"\u003ein\u003c/span\u003e contents.lines() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e config.case_sensitive {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e line.contains(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003econfig.query) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                results.push(line);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        } \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e line.to_lowercase().contains(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003equery) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                results.push(line);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    results\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"运行命令\"\u003e运行命令\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 基本搜索\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecargo run -- hello poem.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 大小写不敏感搜索\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecargo run -- -i hello poem.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"常见陷阱\"\u003e常见陷阱\u003c/h2\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e问题\u003c/th\u003e\n          \u003cth\u003e原因\u003c/th\u003e\n          \u003cth\u003e解决方案\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e参数越界\u003c/td\u003e\n          \u003ctd\u003e忘记检查 args.len()\u003c/td\u003e\n          \u003ctd\u003e加长度检查\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e大小写搜索低效\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003equery.to_lowercase()\u003c/code\u003e 重复计算\u003c/td\u003e\n          \u003ctd\u003e提取到循环外\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e所有权转移\u003c/td\u003e\n          \u003ctd\u003eString 传入函数\u003c/td\u003e\n          \u003ctd\u003e使用引用 \u003ccode\u003e\u0026amp;str\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"关键要点\"\u003e关键要点\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003eenv::args()\u003c/code\u003e 返回 \u003ccode\u003eIterator\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003efs::read_to_string()\u003c/code\u003e 读取整个文件\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eConfig\u003c/code\u003e 模式解耦配置与业务逻辑\u003c/li\u003e\n\u003cli\u003e大小写不敏感：两边都转小写再比较\u003c/li\u003e\n\u003cli\u003e用 \u003ccode\u003eResult\u003c/code\u003e 处理用户输入错误更优雅\u003c/li\u003e\n\u003c/ol\u003e","title":"Rust - IO"},{"content":"Rust - 自动化测试 知识概览 核心主题：Rust 内置测试框架、单元测试、集成测试 重要性：⭐⭐⭐⭐ 掌握测试是工程化开发的基础 前置知识：泛型与 Trait（第10章）、所有权（第4章） 核心概念 测试框架架构 Rust 内置测试框架，无需外部依赖，通过 #[test] 属性标记测试函数。\n#[cfg(test)] // 仅在测试时编译 mod tests { use super::*; // 访问被测试模块 #[test] fn it_works() { assert_eq!(2 + 2, 4); assert!(true); } #[test] #[should_panic(expected = \u0026#34;错误信息\u0026#34;)] fn it_panics() { panic!(\u0026#34;错误信息\u0026#34;); } } 断言宏 宏 用途 示例 assert!(cond) 条件为真 assert!(x \u0026gt; 0) assert_eq!(a, b) 两值相等 assert_eq!(result, 5) assert_ne!(a, b) 两值不等 assert_ne!(result, 0) 测试组织方式 单元测试：同文件 mod tests 内 集成测试：tests/ 目录下的独立文件 文档测试：doc comment /// 中的代码示例 常用派生 trait #[derive(Debug, Clone, PartialEq)] pub struct Rectangle { pub width: u32, pub height: u32, } trait 作用 Debug 支持 {:?} 打印 Clone 支持 .clone() 克隆 PartialEq 支持 = 比较 实践项目 Rectangle 结构体测试 #[derive(Debug)] pub struct Rectangle { pub width: u32, pub height: u32, } impl Rectangle { pub fn can_hold(\u0026amp;self, other: \u0026amp;Rectangle) -\u0026gt; bool { self.width \u0026gt;= other.width \u0026amp;\u0026amp; self.height \u0026gt;= other.height } } #[cfg(test)] mod tests { use super::*; #[test] fn larger_can_hold_smaller() { let larger = Rectangle { width: 8, height: 7 }; let smaller = Rectangle { width: 5, height: 1 }; assert!(larger.can_hold(\u0026amp;smaller)); } #[test] fn smaller_cannot_hold_larger() { let larger = Rectangle { width: 4, height: 7 }; let smaller = Rectangle { width: 5, height: 1 }; assert!(!larger.can_hold(\u0026amp;smaller)); } } 常见陷阱 问题 原因 解决方案 字段不可访问 字段默认私有 pub struct 或公开字段 所有权转移 参数为 Rectangle 而非 \u0026amp;Rectangle 使用借用 \u0026amp;Rectangle 调试打印失败 未派生 Debug 添加 #[derive(Debug)] 运行测试 cargo test # 运行所有测试 cargo test test_name # 运行指定测试 关键要点 #[cfg(test)] 仅在测试时编译 #[test] 标记测试函数 #[should_panic] 预期 panic 用 \u0026amp;Rectangle 借用避免所有权转移 #[derive(Debug)] 支持调试打印 ","permalink":"https://nikoart-liu.github.io/posts/rust%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/","summary":"\u003ch1 id=\"rust---自动化测试\"\u003eRust - 自动化测试\u003c/h1\u003e\n\u003ch2 id=\"知识概览\"\u003e知识概览\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e核心主题\u003c/strong\u003e：Rust 内置测试框架、单元测试、集成测试\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e重要性\u003c/strong\u003e：⭐⭐⭐⭐ 掌握测试是工程化开发的基础\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e前置知识\u003c/strong\u003e：泛型与 Trait（第10章）、所有权（第4章）\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"核心概念\"\u003e核心概念\u003c/h2\u003e\n\u003ch3 id=\"测试框架架构\"\u003e测试框架架构\u003c/h3\u003e\n\u003cp\u003eRust 内置测试框架，无需外部依赖，通过 \u003ccode\u003e#[test]\u003c/code\u003e 属性标记测试函数。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-rust\" data-lang=\"rust\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#[cfg(test)]\u003c/span\u003e  \u003cspan style=\"color:#75715e\"\u003e// 仅在测试时编译\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003emod\u003c/span\u003e tests {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003euse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003esuper\u003c/span\u003e::\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e;  \u003cspan style=\"color:#75715e\"\u003e// 访问被测试模块\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e#[test]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eit_works\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003eassert_eq!\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003eassert!\u003c/span\u003e(\u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e#[test]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e#[should_panic(expected = \u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;错误信息\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e)]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eit_panics\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003epanic!\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;错误信息\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"断言宏\"\u003e断言宏\u003c/h3\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e宏\u003c/th\u003e\n          \u003cth\u003e用途\u003c/th\u003e\n          \u003cth\u003e示例\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eassert!(cond)\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e条件为真\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eassert!(x \u0026gt; 0)\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eassert_eq!(a, b)\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e两值相等\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eassert_eq!(result, 5)\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eassert_ne!(a, b)\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e两值不等\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eassert_ne!(result, 0)\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"测试组织方式\"\u003e测试组织方式\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003e单元测试\u003c/strong\u003e：同文件 \u003ccode\u003emod tests\u003c/code\u003e 内\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e集成测试\u003c/strong\u003e：\u003ccode\u003etests/\u003c/code\u003e 目录下的独立文件\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e文档测试\u003c/strong\u003e：doc comment \u003ccode\u003e///\u003c/code\u003e 中的代码示例\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"常用派生-trait\"\u003e常用派生 trait\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-rust\" data-lang=\"rust\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#[derive(Debug, Clone, PartialEq)]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003epub\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eRectangle\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003epub\u003c/span\u003e width: \u003cspan style=\"color:#66d9ef\"\u003eu32\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003epub\u003c/span\u003e height: \u003cspan style=\"color:#66d9ef\"\u003eu32\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003etrait\u003c/th\u003e\n          \u003cth\u003e作用\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eDebug\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e支持 \u003ccode\u003e{:?}\u003c/code\u003e 打印\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003eClone\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e支持 \u003ccode\u003e.clone()\u003c/code\u003e 克隆\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ccode\u003ePartialEq\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e支持 \u003ccode\u003e=\u003c/code\u003e 比较\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"实践项目\"\u003e实践项目\u003c/h2\u003e\n\u003ch3 id=\"rectangle-结构体测试\"\u003eRectangle 结构体测试\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-rust\" data-lang=\"rust\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#[derive(Debug)]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003epub\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eRectangle\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003epub\u003c/span\u003e width: \u003cspan style=\"color:#66d9ef\"\u003eu32\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003epub\u003c/span\u003e height: \u003cspan style=\"color:#66d9ef\"\u003eu32\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eimpl\u003c/span\u003e Rectangle {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003epub\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecan_hold\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eself, other: \u003cspan style=\"color:#66d9ef\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eRectangle\u003c/span\u003e) -\u0026gt; \u003cspan style=\"color:#66d9ef\"\u003ebool\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        self.width \u003cspan style=\"color:#f92672\"\u003e\u0026gt;=\u003c/span\u003e other.width \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e self.height \u003cspan style=\"color:#f92672\"\u003e\u0026gt;=\u003c/span\u003e other.height\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#[cfg(test)]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003emod\u003c/span\u003e tests {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003euse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003esuper\u003c/span\u003e::\u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e#[test]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elarger_can_hold_smaller\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e larger \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e Rectangle { width: \u003cspan style=\"color:#ae81ff\"\u003e8\u003c/span\u003e, height: \u003cspan style=\"color:#ae81ff\"\u003e7\u003c/span\u003e };\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e smaller \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e Rectangle { width: \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e, height: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e };\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003eassert!\u003c/span\u003e(larger.can_hold(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003esmaller));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e#[test]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003esmaller_cannot_hold_larger\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e larger \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e Rectangle { width: \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e, height: \u003cspan style=\"color:#ae81ff\"\u003e7\u003c/span\u003e };\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e smaller \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e Rectangle { width: \u003cspan style=\"color:#ae81ff\"\u003e5\u003c/span\u003e, height: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e };\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#a6e22e\"\u003eassert!\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e!\u003c/span\u003elarger.can_hold(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003esmaller));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"常见陷阱\"\u003e常见陷阱\u003c/h2\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e问题\u003c/th\u003e\n          \u003cth\u003e原因\u003c/th\u003e\n          \u003cth\u003e解决方案\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e字段不可访问\u003c/td\u003e\n          \u003ctd\u003e字段默认私有\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003epub struct\u003c/code\u003e 或公开字段\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e所有权转移\u003c/td\u003e\n          \u003ctd\u003e参数为 \u003ccode\u003eRectangle\u003c/code\u003e 而非 \u003ccode\u003e\u0026amp;Rectangle\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e使用借用 \u003ccode\u003e\u0026amp;Rectangle\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e调试打印失败\u003c/td\u003e\n          \u003ctd\u003e未派生 \u003ccode\u003eDebug\u003c/code\u003e\u003c/td\u003e\n          \u003ctd\u003e添加 \u003ccode\u003e#[derive(Debug)]\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"运行测试\"\u003e运行测试\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecargo test        \u003cspan style=\"color:#75715e\"\u003e# 运行所有测试\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecargo test test_name  \u003cspan style=\"color:#75715e\"\u003e# 运行指定测试\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"关键要点\"\u003e关键要点\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003e#[cfg(test)]\u003c/code\u003e 仅在测试时编译\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e#[test]\u003c/code\u003e 标记测试函数\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e#[should_panic]\u003c/code\u003e 预期 panic\u003c/li\u003e\n\u003cli\u003e用 \u003ccode\u003e\u0026amp;Rectangle\u003c/code\u003e 借用避免所有权转移\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e#[derive(Debug)]\u003c/code\u003e 支持调试打印\u003c/li\u003e\n\u003c/ol\u003e","title":"Rust - 自动化测试"},{"content":"Rust - 泛型、Trait 和生命周期 知识概览 本章核心主题：通过抽象机制消除代码重复，实现灵活且安全的代码 重要程度：⭐⭐⭐（核心概念，后续章节的基础） 预计学习时间：2-3小时 前置知识要求： 基本语法（变量、函数、结构体、枚举） 所有权和借用 错误处理的基础（Option、Result） 核心概念 泛型类型（Generics） 定义：允许代码处理多种类型而非具体类型的抽象机制\n官方文档：\nurl: https://doc.rust-lang.org/book/ch10-01-syntax.html title: \u0026#34;Generic Data Types - The Rust Programming Language\u0026#34; host: doc.rust-lang.org favicon: favicon-de23e50b.svg 语法：\n// 函数泛型 fn largest\u0026lt;T: PartialOrd\u0026gt;(list: \u0026amp;[T]) -\u0026gt; \u0026amp;T { let mut largest = \u0026amp;list[0]; for item in list { if item \u0026gt; largest { largest = item; } } largest } // 结构体泛型（单泛型） struct Point\u0026lt;T\u0026gt; { x: T, y: T, } // 结构体泛型（多泛型） struct Point\u0026lt;T, U\u0026gt; { x: T, y: U, } // impl 块 impl\u0026lt;T\u0026gt; Point\u0026lt;T\u0026gt; { fn x(\u0026amp;self) -\u0026gt; \u0026amp;T { \u0026amp;self.x } } // 为特定类型实现方法 impl Point\u0026lt;f32\u0026gt; { fn distance_from_origin(\u0026amp;self) -\u0026gt; f32 { (self.x.powi(2) + self.y.powi(2)).sqrt() } } 性能：通过单态化在编译时生成具体类型代码，零运行时开销\nTrait 定义：定义共享行为的抽象机制，类似其他语言的接口\n官方文档：\nurl: https://doc.rust-lang.org/book/ch10-02-traits.html title: \u0026#34;Defining Shared Behavior with Traits - The Rust Programming Language\u0026#34; host: doc.rust-lang.org favicon: favicon-de23e50b.svg 语法：\n// 定义 Trait pub trait Summary { // 抽象方法（必须实现） fn summarize(\u0026amp;self) -\u0026gt; String; // 默认实现（可选重写） fn summarize_author(\u0026amp;self) -\u0026gt; String { format!(\u0026#34;Anonymous\u0026#34;) } } // 为类型实现 Trait pub struct NewsArticle { pub headline: String, pub location: String, } impl Summary for NewsArticle { fn summarize(\u0026amp;self) -\u0026gt; String { format!(\u0026#34;{}, by {}\u0026#34;, self.headline, self.location) } } Trait Bound 作为参数：\n// 方法 1：impl Trait（简洁） pub fn notify(item: \u0026amp;impl Summary) { println!(\u0026#34;Breaking news: {}\u0026#34;, item.summarize()); } // 方法 2：Trait Bound（灵活） pub fn notify\u0026lt;T: Summary\u0026gt;(item: \u0026amp;T) { println!(\u0026#34;Breaking news: {}\u0026#34;, item.summarize()); } // 多个 Trait pub fn notify\u0026lt;T: Summary + Display\u0026gt;(item: \u0026amp;T) { ... } // where 子句（更清晰） fn some_function\u0026lt;T, U\u0026gt;(t: \u0026amp;T, u: \u0026amp;U) -\u0026gt; i32 where T: Display + Clone, U: Clone + Debug, { // ... } 返回类型：\n// 只能返回一种具体类型（静态分发） fn returns_summarizable() -\u0026gt; impl Summary { NewsArticle { /* ... */ } } // 返回动态类型（有运行时开销） fn get_content(condition: bool) -\u0026gt; Box\u0026lt;dyn Summary\u0026gt; { if condition { Box::new(NewsArticle { /* ... */ }) } else { Box::new(Tweet { /* ... */ }) } } 有条件实现：\nstruct Pair\u0026lt;T\u0026gt; { x: T, y: T } impl\u0026lt;T: Display + PartialOrd\u0026gt; Pair\u0026lt;T\u0026gt; { fn cmp_display(\u0026amp;self) { if self.x \u0026gt;= self.y { println!(\u0026#34;x = {} is larger\u0026#34;, self.x); } else { println!(\u0026#34;y = {} is larger\u0026#34;, self.y); } } } 生命周期（Lifetimes） 定义：确保引用有效性、防止悬垂引用的编译时机制\n官方文档：\nurl: https://doc.rust-lang.org/book/ch10-03-lifetime-syntax.html title: \u0026#34;Validating References with Lifetimes - The Rust Programming Language\u0026#34; host: doc.rust-lang.org favicon: favicon-de23e50b.svg 语法：\n// 函数生命周期标注 fn longest\u0026lt;\u0026#39;a\u0026gt;(x: \u0026amp;\u0026#39;a str, y: \u0026amp;\u0026#39;a str) -\u0026gt; \u0026amp;\u0026#39;a str { if x.len() \u0026gt; y.len() { x } else { y } } // 结构体生命周期 struct ImportantExcerpt\u0026lt;\u0026#39;a\u0026gt; { part: \u0026amp;\u0026#39;a str, } 生命周期省略规则：\n每个引用参数获得独立生命周期 若只有一个输入生命周期，返回值使用相同生命周期 若有 \u0026amp;self 或 \u0026amp;mut self，返回值使用 self 的生命周期 'static 生命周期：表示引用在整个程序运行期间有效（用于字符串字面量）\nlet s: \u0026amp;\u0026#39;static str = \u0026#34;hello\u0026#34;; // 字符串字面量 // 错误示例：不能将非静态数据标注为 \u0026#39;static fn error_example() -\u0026gt; \u0026amp;\u0026#39;static str { let s = String::from(\u0026#34;world\u0026#34;); \u0026amp;s // ❌ 编译错误 } 综合实践 题目：通用时间线结构 // 综合应用题：编写一个通用的\u0026#34;最长时间线\u0026#34;结构 // 要求： // 1. 能够存储事件和它们的时间戳 // 2. 提供查找最新事件的方法 // 3. 提供格式化输出的能力 // 4. 能够比较两个时间线 use std::{cmp::Ordering, cmp::Ord, fmt::Display, fmt::Formatter, fmt::Result}; fn main() { let mut tl1 = Timeline { name: String::from(\u0026#34;Project A\u0026#34;), events: vec![(1, String::from(\u0026#34;启动\u0026#34;)), (3, String::from(\u0026#34;里程碑\u0026#34;))], }; let mut tl2 = Timeline { name: String::from(\u0026#34;Project B\u0026#34;), events: vec![(100, String::from(\u0026#34;启动\u0026#34;)), (500, String::from(\u0026#34;完成\u0026#34;))], }; // 测试 Display println!(\u0026#34;{}\u0026#34;, tl1); println!(\u0026#34;{}\u0026#34;, tl2); if let Some((time, event)) = tl1.latest_event() { println!(\u0026#34;\\n最新事件 ({}): 时间={}, 内容={}\u0026#34;, tl1.name, time, event); } if tl2 \u0026gt; tl1 { println!(\u0026#34;\\n{} 更新\u0026#34;, tl2.name); } } struct Timeline\u0026lt;T: Ord + Display\u0026gt; { name: String, events: Vec\u0026lt;(T, String)\u0026gt;, } impl\u0026lt;T: Ord + Display\u0026gt; Timeline\u0026lt;T\u0026gt; { // 查找最新事件（时间戳最大的） fn latest_event(\u0026amp;self) -\u0026gt; Option\u0026lt;\u0026amp;(T, String)\u0026gt; { self.events.iter().max_by_key(|e| \u0026amp;e.0) } } impl\u0026lt;T: Ord + Display\u0026gt; Display for Timeline\u0026lt;T\u0026gt; { fn fmt(\u0026amp;self, f: \u0026amp;mut Formatter\u0026lt;\u0026#39;_\u0026gt;) -\u0026gt; Result { write!(f, \u0026#34;Timeline: {}\\nEvents:\\n\u0026#34;, self.name)?; for (time, event) in \u0026amp;self.events { writeln!(f, \u0026#34; {}: {}\u0026#34;, time, event)?; } Ok(()) } } impl\u0026lt;T: Ord + Display\u0026gt; PartialOrd for Timeline\u0026lt;T\u0026gt; { fn partial_cmp(\u0026amp;self, other: \u0026amp;Self) -\u0026gt; Option\u0026lt;Ordering\u0026gt; { match (self.latest_event(), other.latest_event()) { (Some((t1, _)), Some((t2, _))) =\u0026gt; t1.partial_cmp(t2), _ =\u0026gt; None, } } } // 为了使用 \u0026gt;= 等操作符 impl\u0026lt;T: Ord + Display\u0026gt; PartialEq for Timeline\u0026lt;T\u0026gt; { fn eq(\u0026amp;self, other: \u0026amp;Self) -\u0026gt; bool { match (self.latest_event(), other.latest_event()) { (Some((t1, _)), Some((t2, _))) =\u0026gt; t1 == t2, _ =\u0026gt; false, } } } 常见问题与陷阱 问题 原因 解决方法 泛型无法使用 + 操作符 泛型默认没有行为能力 添加 Trait 约束 T: std::ops::Add\u0026lt;Output = T\u0026gt; 泛型无法比较 \u0026gt; 缺少比较 Trait 添加 T: PartialOrd 约束 impl Trait 返回多种类型失败 impl Trait 要求返回唯一类型 使用 Box\u0026lt;dyn Trait\u0026gt; 动态分发 Point { x: 5, y: 4.0 } 类型错误 单泛型要求字段类型相同 使用 Point\u0026lt;T, U\u0026gt; 多泛型 \u0026amp;String 不能是 'static String 在函数结束时被销毁 移除 'static 或使用字面量 使用 \u0026gt; 编译失败 PartialOrd 需要 PartialEq 成对实现两者 Trait 快速查询表 场景 需要的 Trait max_by_key(), min(), sort() Ord a \u0026gt; b PartialOrd a == b PartialEq a + b std::ops::Add\u0026lt;Output = T\u0026gt; a.clone() Clone println!(\u0026quot;{}\u0026quot;, a) Display println!(\u0026quot;{:?}\u0026quot;, a) Debug a.to_string() Display（有 blanket 实现） for x in collection IntoIterator collection.len() 通常由类型本身实现 关键要点 泛型 + Trait 约束 = 有用的泛型（否则泛型\u0026quot;什么都做不了\u0026quot;） 生命周期标注用于消除歧义，编译器通过省略规则自动推导 impl Trait 与 Box\u0026lt;dyn Trait\u0026gt;：静态分发（零开销） vs 动态分发（运行时查表） 单态化确保泛型代码零运行时开销 Trait 遵循孤儿规则：只能为本地类型或 trait 实现 字符串字面量自动拥有 'static 生命周期 PartialOrd 必须与 PartialEq 成对实现 ","permalink":"https://nikoart-liu.github.io/posts/rust%E6%B3%9B%E5%9E%8Btrait%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/","summary":"\u003ch1 id=\"rust---泛型trait-和生命周期\"\u003eRust - 泛型、Trait 和生命周期\u003c/h1\u003e\n\u003ch2 id=\"知识概览\"\u003e知识概览\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e本章核心主题：通过抽象机制消除代码重复，实现灵活且安全的代码\u003c/li\u003e\n\u003cli\u003e重要程度：⭐⭐⭐（核心概念，后续章节的基础）\u003c/li\u003e\n\u003cli\u003e预计学习时间：2-3小时\u003c/li\u003e\n\u003cli\u003e前置知识要求：\n\u003cul\u003e\n\u003cli\u003e基本语法（变量、函数、结构体、枚举）\u003c/li\u003e\n\u003cli\u003e所有权和借用\u003c/li\u003e\n\u003cli\u003e错误处理的基础（Option、Result）\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"核心概念\"\u003e核心概念\u003c/h2\u003e\n\u003ch3 id=\"泛型类型generics\"\u003e泛型类型（Generics）\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003e定义\u003c/strong\u003e：允许代码处理多种类型而非具体类型的抽象机制\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e官方文档\u003c/strong\u003e：\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-cardlink\" data-lang=\"cardlink\"\u003eurl: https://doc.rust-lang.org/book/ch10-01-syntax.html\ntitle: \u0026#34;Generic Data Types - The Rust Programming Language\u0026#34;\nhost: doc.rust-lang.org\nfavicon: favicon-de23e50b.svg\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cstrong\u003e语法\u003c/strong\u003e：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-rust\" data-lang=\"rust\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// 函数泛型\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003elargest\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eT: PartialOrd\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e(list: \u003cspan style=\"color:#66d9ef\"\u003e\u0026amp;\u003c/span\u003e[T]) -\u0026gt; \u003cspan style=\"color:#66d9ef\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003elet\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003emut\u003c/span\u003e largest \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003elist[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e item \u003cspan style=\"color:#66d9ef\"\u003ein\u003c/span\u003e list {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e item \u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e largest {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            largest \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e item;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    largest\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// 结构体泛型（单泛型）\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePoint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eT\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    x: \u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    y: \u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// 结构体泛型（多泛型）\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003estruct\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ePoint\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eT, U\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    x: \u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    y: \u003cspan style=\"color:#a6e22e\"\u003eU\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// impl 块\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eimpl\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eT\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e Point\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003eT\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ex\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eself) -\u0026gt; \u003cspan style=\"color:#66d9ef\"\u003e\u0026amp;\u003c/span\u003e\u003cspan style=\"color:#a6e22e\"\u003eT\u003c/span\u003e { \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eself.x }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e// 为特定类型实现方法\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eimpl\u003c/span\u003e Point\u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003ef32\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efn\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003edistance_from_origin\u003c/span\u003e(\u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003eself) -\u0026gt; \u003cspan style=\"color:#66d9ef\"\u003ef32\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        (self.x.powi(\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e self.y.powi(\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e)).sqrt()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003e性能\u003c/strong\u003e：通过单态化在编译时生成具体类型代码，零运行时开销\u003c/p\u003e","title":"Rust - 泛型、Trait 和生命周期"},{"content":"欢迎来到我的博客 这是我在 Hugo 上搭建的第一篇博客文章。\nHugo 是一个用 Go 语言编写的静态网站生成器，它的速度非常快。\n为什么选择 Hugo 生成速度极快 主题丰富 易于部署到 GitHub Pages ","permalink":"https://nikoart-liu.github.io/posts/helloworld/","summary":"\u003ch1 id=\"欢迎来到我的博客\"\u003e欢迎来到我的博客\u003c/h1\u003e\n\u003cp\u003e这是我在 Hugo 上搭建的第一篇博客文章。\u003c/p\u003e\n\u003cp\u003eHugo 是一个用 Go 语言编写的静态网站生成器，它的速度非常快。\u003c/p\u003e\n\u003ch2 id=\"为什么选择-hugo\"\u003e为什么选择 Hugo\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e生成速度极快\u003c/li\u003e\n\u003cli\u003e主题丰富\u003c/li\u003e\n\u003cli\u003e易于部署到 GitHub Pages\u003c/li\u003e\n\u003c/ol\u003e","title":"Hello World"}]